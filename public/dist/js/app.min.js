!function(){angular.module("AioCamera",["ngRoute"]),angular.module("AioCamera").constant("VIEW_PATH","client/views"),angular.module("AioCamera").controller("CameraController",[function(){this.orientation=null,this.mode="streaming",this.modesAvailable=["streaming","photo","video"],this.config={width:1e3,height:1e3,flipY:!0,flipX:!1,rotation:0,sharpness:0,contrast:0,brightness:50,saturation:0,iso:100,stabilisation:!1,evCompensation:0,exposureMode:"auto",awb:"auto",imageEffect:"none",colourEffect:null,meteringMode:"average"},this.preview={fillColor:"#000100",url:"files/camera/tmp/snapshot.jpg",fullscreen:!0},this.openedWindow={config:!1,records:!1},this.toggleConfigWindow=function(){this.openedWindow.config||(this.openedWindow.records=!1),this.openedWindow.config=!this.openedWindow.config},this.toggleRecordsWindow=function(){this.openedWindow.records||(this.openedWindow.config=!1),this.openedWindow.records=!this.openedWindow.records},this.toggleFullscreen=function(){this.preview.fullscreen=!this.preview.fullscreen}}]),angular.module("AioCamera").directive("camera",["$window","VIEW_PATH",function(a,b){function c(a){var b="landscape";return a.innerHeight>a.innerWidth&&(b="portrait"),b}return{restrict:"E",replace:!0,templateUrl:b+"/Camera/camera.html",controller:"CameraController",controllerAs:"cameraCtrl",scope:{},link:function(b,d,e,f){f.orientation=c(a),$(a).on("resize",function(){f.orientation=c(a),b.$apply()}),b.$on("$destroy",function(){$(a).off("resize")})}}}]),angular.module("AioCamera").controller("CameraConfigController",[function(){this.parameters={},this.rotations={0:"0°",90:"90°",270:"270°"},this.exposureModes=["off","auto","night","nightpreview","backlight","spotlight","sports","snow","beach","verylong","fixedfps","antishake","fireworks"],this.awbModes=["off","auto","sun","cloud","shade","tungsten","fluorescent","incandescent","flash","horizon"],this.imageEffects=["none","negative","solarise","sketch","denoise","emboss","oilpaint","hatch","gpen","pastel","watercolour","film","blur","saturation","colourswap","washedout","posterise","colourpoint","colourbalance","cartoon"],this.meteringModes=["average","spot","backlit","matrix"]}]),angular.module("AioCamera").directive("cameraConfig",["VIEW_PATH",function(a){return{restrict:"E",replace:!0,templateUrl:a+"/CameraConfig/camera-config.html",controller:"CameraConfigController",controllerAs:"cameraConfigCtrl",scope:{config:"="},link:function(a,b,c,d){a.$watch("config",function(a){d.parameters=a}),a.$on("$destroy",function(){})}}}]),angular.module("AioCamera").controller("CameraRecordsController",[function(){this.records=[]}]),angular.module("AioCamera").directive("cameraRecords",["VIEW_PATH",function(a){return{restrict:"E",replace:!0,templateUrl:a+"/CameraRecord/camera-records.html",controller:"CameraRecordsController",controllerAs:"cameraRecordsCtrl",scope:{},link:function(a,b,c,d){a.$on("$destroy",function(){})}}}]),angular.module("AioCamera").controller("RangeFieldController",[function(){this.value=null,this.fill=null,this.min=null,this.max=null,this.dataRange=null,this.step=1,this.steps=null,this.showMilestones=!0,this.showValue=!0,this.setValue=function(a){a=angular.isDefined(a)?Number(a):null,a!==this.value&&(this.value=a,this.calculateFill())},this.setMin=function(a){a=angular.isDefined(a)?Number(a):null,a!==this.min&&(this.min=a,this.calculateDataRange(),this.calculateFill())},this.setMax=function(a){a=angular.isDefined(a)?Number(a):null,a!==this.max&&(this.max=a,this.calculateDataRange(),this.calculateFill())},this.setStep=function(a){a=angular.isDefined(a)?Number(a):1,a!==this.step&&(this.step=a,this.calculateSteps())},this.setShowValue=function(a){this.showValue=!(angular.isDefined(a)&&("false"==a||!a))},this.setShowMilestones=function(a){this.showMilestones=!(angular.isDefined(a)&&("false"==a||!a))},this.calculateFill=function(){this.fill=100*(this.value-this.min)/this.dataRange},this.calculateDataRange=function(){if(this.dataRange=null,"undefined"!=typeof this.min&&null!==this.min&&"undefined"!=typeof this.max&&null!==this.max){if(this.max<=this.min)throw new Error("RangeField : `min` ("+this.min+") value can not be greater than `max` ("+this.max+") value.");this.dataRange=this.max-this.min,this.calculateSteps()}},this.calculateSteps=function(){if(this.steps=null,"undefined"!=typeof this.dataRange&&null!==this.dataRange){if(this.step>this.dataRange)throw new Error("RangeFieldDirective :  `step` ("+this.step+") must be smaller than the full data range between `min` ("+this.min+") and `max` ("+this.max+") milestones.");this.steps=Math.floor(this.dataRange/this.step)}}}]),angular.module("AioCamera").directive("radioField",["VIEW_PATH",function(a){return{restrict:"E",replace:!0,templateUrl:a+"/Form/radio-field.html",scope:{value:"=?",options:"="},link:function(a,b,c){a.value=angular.isDefined(a.value)?a.value:null,a.setValue=function(b){a.value=b}}}}]),angular.module("AioCamera").directive("rangeField",["$window","VIEW_PATH",function(a,b){return{restrict:"E",replace:!0,templateUrl:b+"/Form/range-field.html",controller:"RangeFieldController",controllerAs:"rangeField",scope:{value:"=",min:"@",max:"@",step:"@?",showMilestones:"@?",showValue:"@?"},link:function(b,c,d,e){function f(a){var c=j.offset(),d=c.left,f=j.width(),g=d+f,h=Math.floor(e.dataRange/e.step),i=f/h,k=a.clientX;if(d>=k)b.value=e.min;else if(k>=g)b.value=e.max;else{var l=k-d,m=(l-l%i)/i;l%i>e.step/2&&m++,b.value=Math.floor(e.min+m*e.step)}b.$apply()}function g(b){b.target!=k.get()[0]||l||(k.get()[0].focus(),l=!0,a.addEventListener("mousemove",f,!0),b.preventDefault())}function h(b){l&&(l=!1,a.removeEventListener("mousemove",f,!0))}function i(a){l||f(a)}b.$watch("value",function(a){e.setValue(a)},!0),b.$watch("min",function(a){e.setMin(a)},!0),b.$watch("max",function(a){e.setMax(a)},!0),b.$watch("step",function(a){e.setStep(a)},!0),b.$watch("showMilestones",function(a){e.setShowMilestones(a)},!0),b.$watch("showValue",function(a){e.setShowValue(a)},!0);var j=c.find(".progress"),k=j.find(".progress-handler"),l=!1;a.addEventListener("mousedown",g,!0),a.addEventListener("mouseup",h,!0),j.get()[0].addEventListener("click",i,!0),k.get()[0].addEventListener("focus",function(b){console.log("focusin"),a.addEventListener("keydown",function(a){},!0),a.addEventListener("keypress",function(a){},!0),a.addEventListener("keyup",function(a){},!0)},!0),k.get()[0].addEventListener("blur",function(a){console.log("focusout")},!0),b.$on("$destroy",function(){a.removeEventListener("mousedown",g,!0),a.removeEventListener("mouseup",h,!0),j.get()[0].removeEventListener("click",i,!0)})}}}]),angular.module("AioCamera").directive("switchField",["VIEW_PATH",function(a){return{restrict:"E",replace:!0,templateUrl:a+"/Form/switch-field.html",scope:{value:"=?"},link:function(a,b,c){a.value=a.value?!0:!1}}}])}();